<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Book Log</title>
<style>
    :root {
        --primary-color: #4a90e2;
        --site-title-color: #4a90e2; /* new variable for site title color */
        --secondary-color: #f2f2f2;
        --text-color: #333;
        --header-bg: #f2f2f2;
        --font-family: Arial, sans-serif;
        --file-text-color: transparent;
    }

    body {
        font-family: var(--font-family);
        background-color: var(--secondary-color);
        color: var(--text-color);
        margin: 0;
        padding: 0;
    }

    header {
        background-color: var(--header-bg);
        text-align: center;
        padding: 20px;
    }

    h1 {
        margin: 0;
        padding: 10px 0;
        color: var(--site-title-color); /* uses new variable */
    }

    main {
        max-width: 800px;
        margin: 20px auto;
        padding: 10px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    table, th, td {
        border: 1px solid #ddd;
    }

    th, td {
        padding: 10px;
        text-align: left;
    }

    th {
        background-color: var(--primary-color);
        color: white;
    }

    form {
        margin-top: 20px;
    }

    form input, form textarea, form select, form button {
        width: 100%;
        padding: 8px;
        margin: 5px 0;
        box-sizing: border-box;
    }

    form button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        cursor: pointer;
        margin-top: 5px;
    }

    form button:hover {
        background-color: #357ABD;
    }

    .action-link {
        cursor: pointer;
        color: var(--primary-color);
        text-decoration: underline;
        margin-right: 10px;
        background: none;
        border: none;
        padding: 0;
        font-size: 1em;
    }

    #themeEditor {
        display: none;
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background: #fafafa;
    }

    #themeToggleContainer {
        position: sticky;
        top: 10px;
        background: white;
        padding: 5px 0;
        z-index: 100;
    }

    .image-container {
        display: inline-block;
        position: relative;
        margin: 5px;
    }

    .remove-image {
        position: absolute;
        top: 2px;
        right: 2px;
        background: rgba(0,0,0,0.4);
        color: white;
        font-size: 14px;
        border: none;
        cursor: pointer;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        line-height: 18px;
        text-align: center;
        opacity: 0.7;
        transition: opacity 0.2s;
    }

    .remove-image:hover {
        opacity: 1;
    }

    input[type="file"] {
        color: var(--file-text-color);
    }

    header img, footer img {
        max-width: 150px;
        margin: 5px;
    }

    footer {
        background-color: var(--header-bg);
        text-align: center;
        padding: 20px;
    }
</style>
</head>
<body>
<header>
    <h1 id="siteTitle">My Book Log</h1>
    <div id="headerImages"></div>
</header>

<main>
    <h2 id="formTitle">Add a Book</h2>

    <table id="bookTable">
        <thead>
        <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Date Read</th>
            <th>Notes</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</main>

<footer>
    <div id="footerImages"></div>
</footer>

<script>
    let books = [];
    let theme = {};

    // Fetch data from data.json
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            books = data.books || [];
            theme = data.theme || {};
            renderBooks();
            applyTheme();
            renderImages('headerImages', data.headerImages || []);
            renderImages('footerImages', data.footerImages || []);
        })
        .catch(err => console.error('Error loading data.json:', err));

    // Render book table
    const tableBody = document.querySelector('#bookTable tbody');
    function renderBooks() {
        tableBody.innerHTML = '';
        [...books].reverse().forEach(book => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${book.title}</td>
                <td>${book.author}</td>
                <td>${book.dateRead}</td>
                <td>${book.notes}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Render images
    function renderImages(containerId, images) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';
        images.forEach(src => {
            const div = document.createElement('div');
            div.className = 'image-container';
            const img = document.createElement('img');
            img.src = src;
            div.appendChild(img);
            container.appendChild(div);
        });
    }

    // Apply theme
    function applyTheme() {
        if(theme.title) document.getElementById('siteTitle').textContent = theme.title;
        if(theme.titleColor) document.documentElement.style.setProperty('--site-title-color', theme.titleColor);
        if(theme.formTitle) document.getElementById('formTitle').textContent = theme.formTitle;
        if(theme.primaryColor) document.documentElement.style.setProperty('--primary-color', theme.primaryColor);
        if(theme.secondaryColor) document.documentElement.style.setProperty('--secondary-color', theme.secondaryColor);
        if(theme.textColor) document.documentElement.style.setProperty('--text-color', theme.textColor);
        if(theme.headerColor) document.documentElement.style.setProperty('--header-bg', theme.headerColor);
        if(theme.fontFamily) document.documentElement.style.setProperty('--font-family', theme.fontFamily);
        if(theme.fileTextColor) document.documentElement.style.setProperty('--file-text-color', theme.fileTextColor);
    }
</script>
</body>
</html>
