<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Book Log</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f2f2f2;
            --text-color: #333;
            --header-bg: #f2f2f2;
            --font-family: Arial, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }

        header, footer {
            background-color: var(--header-bg);
            text-align: center;
            padding: 20px;
        }

        header img, footer img {
            max-width: 150px;
            margin: 5px;
            height: auto;
        }

        h1 {
            margin: 0;
            padding: 10px 0;
            color: var(--primary-color);
        }

        main {
            max-width: 800px;
            margin: 20px auto;
            padding: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }

        form {
            margin-top: 20px;
        }

        form input, form textarea, form select, form button {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            box-sizing: border-box;
        }

        form button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 5px;
        }

        form button:hover {
            background-color: #357ABD;
        }

        .action-link {
            cursor: pointer;
            color: var(--primary-color);
            text-decoration: underline;
            margin-right: 10px;
            background: none;
            border: none;
            padding: 0;
            font-size: 1em;
        }

        #themeEditor {
            display: none;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #fafafa;
        }

        #themeToggleContainer {
            position: sticky;
            top: 10px;
            background: white;
            padding: 5px 0;
            z-index: 100;
        }

        .image-container {
            display: inline-block;
            position: relative;
            margin: 5px;
        }

        .remove-image {
            position: absolute;
            top: 2px;
            right: 2px;
            background: rgba(0,0,0,0.4);
            color: white;
            font-size: 14px;
            border: none;
            cursor: pointer;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            line-height: 18px;
            text-align: center;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .remove-image:hover {
            opacity: 1;
        }

        /* Subtle file input button */
        input[type="file"] {
            padding: 5px;
            font-size: 0.9em;
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
        }
        input[type="file"]::file-selector-button {
            background-color: #e0e0e0;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: #d0d0d0;
        }
    </style>
</head>
<body>
<header>
    <h1 id="siteTitle">My Book Log</h1>
    <div id="headerImages"></div>
    <input type="file" id="headerUpload" accept="image/*" multiple>
</header>

<main>
    <h2 id="formTitle">Add a Book</h2>
    <form id="bookForm">
        <input type="text" id="title" placeholder="Book Title" required>
        <input type="text" id="author" placeholder="Author" required>
        <input type="date" id="dateRead" required>
        <textarea id="notes" placeholder="Notes"></textarea>
        <button type="submit">Add Book</button>
    </form>

    <div id="themeToggleContainer">
        <label id="themeToggle">
            Show Theme Editor:
            <select id="themeSelect">
                <option value="hide">Hide</option>
                <option value="show">Show</option>
            </select>
        </label>
    </div>

    <div id="themeEditor">
        <h3>Theme Editor</h3>
        <label>Site Title: <input type="text" id="themeTitle"></label><br>
        <label>Form Title ("Add a Book"): <input type="text" id="themeFormTitle"></label><br>
        <label>Primary Color: <input type="color" id="themePrimary"></label><br>
        <label>Secondary Color (background): <input type="color" id="themeSecondary"></label><br>
        <label>Text Color: <input type="color" id="themeText"></label><br>
        <label>Header/Footer Color: <input type="color" id="themeHeader"></label><br>
        <label>Font Family:
            <select id="themeFont">
                <option value="Arial, sans-serif">Arial</option>
                <option value="Georgia, serif">Georgia</option>
                <option value="Tahoma, sans-serif">Tahoma</option>
                <option value="Courier New, monospace">Courier New</option>
                <option value="Verdana, sans-serif">Verdana</option>
            </select>
        </label>
    </div>

    <table id="bookTable">
        <thead>
        <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Date Read</th>
            <th>Notes</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</main>

<footer>
    <div id="footerImages"></div>
    <input type="file" id="footerUpload" accept="image/*" multiple>
</footer>

<script>
    // ==== Book Log ====
    const form = document.getElementById('bookForm');
    const tableBody = document.querySelector('#bookTable tbody');
    const formTitle = document.getElementById('formTitle');
    let books = JSON.parse(localStorage.getItem('books')) || [];
    let editIndex = null;

    function renderBooks() {
        tableBody.innerHTML = '';
        books.forEach((book, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${book.title}</td>
                <td>${book.author}</td>
                <td>${book.dateRead}</td>
                <td>${book.notes}</td>
                <td>
                    <button class="action-link" onclick="editBook(${index})">Edit</button>
                    <button class="action-link" onclick="deleteBook(${index})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    function saveBooks() {
        localStorage.setItem('books', JSON.stringify(books));
        renderBooks();
    }

    function editBook(index) {
        editIndex = index;
        const book = books[index];
        document.getElementById('title').value = book.title;
        document.getElementById('author').value = book.author;
        document.getElementById('dateRead').value = book.dateRead;
        document.getElementById('notes').value = book.notes;
        formTitle.textContent = 'Edit Book';
        form.querySelector('button').textContent = 'Save Changes';
    }

    function deleteBook(index) {
        if (confirm('Are you sure you want to delete this book?')) {
            books.splice(index, 1);
            saveBooks();
            if (editIndex === index) {
                form.reset();
                formTitle.textContent = 'Add a Book';
                form.querySelector('button').textContent = 'Add Book';
                editIndex = null;
            }
        }
    }

    form.addEventListener('submit', e => {
        e.preventDefault();
        const newBook = {
            title: document.getElementById('title').value,
            author: document.getElementById('author').value,
            dateRead: document.getElementById('dateRead').value,
            notes: document.getElementById('notes').value
        };
        if (editIndex !== null) {
            books[editIndex] = newBook;
            editIndex = null;
            formTitle.textContent = 'Add a Book';
            form.querySelector('button').textContent = 'Add Book';
        } else {
            books.push(newBook);
        }
        saveBooks();
        form.reset();
    });

    renderBooks();

    // ==== Header/Footer Images ====
    const headerImagesDiv = document.getElementById('headerImages');
    const footerImagesDiv = document.getElementById('footerImages');

    function loadImages(key, container) {
        const images = JSON.parse(localStorage.getItem(key)) || [];
        container.innerHTML = '';
        images.forEach((src, i) => {
            const div = document.createElement('div');
            div.className = 'image-container';
            const img = document.createElement('img');
            img.src = src;
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-image';
            removeBtn.innerText = 'Ã—';
            removeBtn.onclick = () => {
                images.splice(i, 1);
                localStorage.setItem(key, JSON.stringify(images));
                loadImages(key, container);
            };
            div.appendChild(img);
            div.appendChild(removeBtn);
            container.appendChild(div);
        });
    }

    function handleImageUpload(event, key, container) {
        const files = Array.from(event.target.files);
        const images = JSON.parse(localStorage.getItem(key)) || [];
        files.forEach(file => {
            const reader = new FileReader();
            reader.onload = () => {
                images.push(reader.result);
                localStorage.setItem(key, JSON.stringify(images));
                loadImages(key, container);
            };
            reader.readAsDataURL(file);
        });
    }

    document.getElementById('headerUpload').addEventListener('change', e => handleImageUpload(e, 'headerImages', headerImagesDiv));
    document.getElementById('footerUpload').addEventListener('change', e => handleImageUpload(e, 'footerImages', footerImagesDiv));

    loadImages('headerImages', headerImagesDiv);
    loadImages('footerImages', footerImagesDiv);

    // ==== Theme Editor ====
    const siteTitle = document.getElementById('siteTitle');
    const themeTitleInput = document.getElementById('themeTitle');
    const themeFormTitleInput = document.getElementById('themeFormTitle');
    const themePrimaryInput = document.getElementById('themePrimary');
    const themeSecondaryInput = document.getElementById('themeSecondary');
    const themeTextInput = document.getElementById('themeText');
    const themeHeaderInput = document.getElementById('themeHeader');
    const themeFontInput = document.getElementById('themeFont');
    const themeEditorDiv = document.getElementById('themeEditor');
    const themeSelect = document.getElementById('themeSelect');

    themeSelect.addEventListener('change', () => {
        themeEditorDiv.style.display = themeSelect.value === 'show' ? 'block' : 'none';
    });

    function loadTheme() {
        const theme = JSON.parse(localStorage.getItem('theme')) || {};
        if(theme.title) { siteTitle.textContent = theme.title; themeTitleInput.value = theme.title; }
        if(theme.formTitle) { formTitle.textContent = theme.formTitle; themeFormTitleInput.value = theme.formTitle; }
        if(theme.primaryColor) { document.documentElement.style.setProperty('--primary-color', theme.primaryColor); themePrimaryInput.value = theme.primaryColor; }
        if(theme.secondaryColor) { document.documentElement.style.setProperty('--secondary-color', theme.secondaryColor); themeSecondaryInput.value = theme.secondaryColor; }
        if(theme.textColor) { document.documentElement.style.setProperty('--text-color', theme.textColor); themeTextInput.value = theme.textColor; }
        if(theme.headerColor) { document.documentElement.style.setProperty('--header-bg', theme.headerColor); themeHeaderInput.value = theme.headerColor; }
        if(theme.fontFamily) { document.documentElement.style.setProperty('--font-family', theme.fontFamily); themeFontInput.value = theme.fontFamily; }
    }

    function saveTheme() {
        const theme = {
            title: themeTitleInput.value,
            formTitle: themeFormTitleInput.value,
            primaryColor: themePrimaryInput.value,
            secondaryColor: themeSecondaryInput.value,
            textColor: themeTextInput.value,
            headerColor: themeHeaderInput.value,
            fontFamily: themeFontInput.value
        };
        localStorage.setItem('theme', JSON.stringify(theme));
    }

    themeTitleInput.addEventListener('input', () => { siteTitle.textContent = themeTitleInput.value; saveTheme(); });
    themeFormTitleInput.addEventListener('input', () => { formTitle.textContent = themeFormTitleInput.value; saveTheme(); });
    themePrimaryInput.addEventListener('input', () => { document.documentElement.style.setProperty('--primary-color', themePrimaryInput.value); saveTheme(); });
    themeSecondaryInput.addEventListener('input', () => { document.documentElement.style.setProperty('--secondary-color', themeSecondaryInput.value); saveTheme(); });
    themeTextInput.addEventListener('input', () => { document.documentElement.style.setProperty('--text-color', themeTextInput.value); saveTheme(); });
    themeHeaderInput.addEventListener('input', () => { document.documentElement.style.setProperty('--header-bg', themeHeaderInput.value); saveTheme(); });
    themeFontInput.addEventListener('change', () => { document.documentElement.style.setProperty('--font-family', themeFontInput.value); saveTheme(); });

    loadTheme();
</script>
</body>
</html>